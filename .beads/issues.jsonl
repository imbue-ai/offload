{"id":"code-1","title":"Update Cargo.toml to Rust 2024 edition","description":"Change edition from 2021 to 2024 in Cargo.toml. This enables Rust 2024 edition defaults as required by STYLE_GUIDE.md.","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-27T00:03:24.575536013Z","created_by":"Danver Braganza","updated_at":"2026-01-27T00:08:37.563787672Z"}
{"id":"code-10","title":"Rename project: Update src/*.rs files from offload to offload","description":"Update all references in Rust source files from 'offload' to 'offload'. This includes:\n- src/main.rs: CLI name, default config file, use statements\n- src/lib.rs: crate docs and examples\n- src/config.rs: doc comments\n- src/config/schema.rs: struct names (OffloadConfig -\u003e OffloadConfig), doc comments\n- src/bundled.rs: cache directory paths\n- src/report.rs: doc examples\n- src/report/junit.rs: testsuite default name\n- src/provider.rs, src/provider/*.rs: doc examples\n- src/framework.rs, src/framework/*.rs: doc examples\n- src/orchestrator.rs, src/orchestrator/*.rs: doc examples and sandbox ID prefix\n- src/connector.rs: doc examples\n\nThe struct OffloadConfig should be renamed to OffloadConfig, and the field 'offload' in Config should be renamed to 'offload'.","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-29T18:24:57.591601347Z","created_by":"Danver Braganza","updated_at":"2026-01-29T18:42:11.144979343Z"}
{"id":"code-11","title":"Rename project: Rename offload-*.toml config files to offload-*.toml","description":"Rename all configuration files with 'offload' prefix to use 'offload' prefix:\n- offload.toml -\u003e offload.toml\n- offload-local.toml -\u003e offload-local.toml\n- offload-modal.toml -\u003e offload-modal.toml\n- offload-cargo-local.toml -\u003e offload-cargo-local.toml\n- offload-cargo-modal.toml -\u003e offload-cargo-modal.toml\n- offload-computronium-modal.toml -\u003e offload-computronium-modal.toml\n- offload-sculptor-modal.toml -\u003e offload-sculptor-modal.toml\n\nAlso update the [offload] section in these files to [offload].","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-29T18:25:03.560121502Z","created_by":"Danver Braganza","updated_at":"2026-01-29T18:45:18.15783543Z"}
{"id":"code-12","title":"Rename project: Update README.md from offload to offload","description":"Update README.md to replace all references to 'offload' with 'offload'. This includes:\n- Project title\n- Feature descriptions\n- Installation commands\n- CLI examples (offload init, offload run, etc.)\n- Configuration file references (offload.toml -\u003e offload.toml)\n- Example configuration sections ([offload] -\u003e [offload])\n- All documentation text","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-29T18:25:08.706866046Z","created_by":"Danver Braganza","updated_at":"2026-01-29T18:50:11.476117046Z"}
{"id":"code-13","title":"Rename project: Update scripts/modal_sandbox.py from offload to offload","description":"Update scripts/modal_sandbox.py to replace all references to 'offload' with 'offload'. This includes:\n- Module docstring\n- CLI help text\n- Modal App names (offload-sandbox -\u003e offload-sandbox, offload-rust-sandbox -\u003e offload-rust-sandbox, etc.)\n- Function docstrings\n- Comments","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-29T18:25:14.017333924Z","created_by":"Danver Braganza","updated_at":"2026-01-29T18:52:06.241321461Z"}
{"id":"code-14","title":"Rename project: Update .gitignore and .beads/issues.jsonl from offload to offload","description":"Update supporting files:\n- .gitignore: Change offload.local.toml to offload.local.toml\n- .beads/issues.jsonl: Update any references to 'offload' in issue descriptions to 'offload'","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-29T18:25:18.236357134Z","created_by":"Danver Braganza","updated_at":"2026-01-29T19:03:04.743285513Z"}
{"id":"code-15","title":"Update hardcoded paths in config files to use @modal_sandbox.py syntax","description":"Update offload-sculptor-modal.toml and offload-computronium-modal.toml to replace hardcoded paths like:\n  /Users/jacobkirmayer/imbue/shotgun-rs/scripts/modal_sandbox.py\nwith the portable syntax:\n  @modal_sandbox.py\n\nThis removes developer-specific paths and uses the project's script lookup feature.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-29T19:08:54.018824302Z","created_by":"Danver Braganza","updated_at":"2026-01-29T19:08:54.018824302Z"}
{"id":"code-16","title":"Add dockerfile_path field to DefaultProviderConfig","description":"Add an optional 'dockerfile_path' field (Option\u003cString\u003e) to DefaultProviderConfig. This field represents a relative path to a Dockerfile that can be used when creating Modal sandboxes from custom Docker images.\n\nInclude:\n- The new field with serde attributes\n- Doc comments explaining it's a relative path to a Dockerfile\n- Default value of None\n\nFiles to modify:\n- src/config/schema.rs (add field to DefaultProviderConfig)","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-29T19:54:17.354981257Z","created_by":"Danver Braganza","updated_at":"2026-01-29T20:37:07.288571836Z"}
{"id":"code-17","title":"Add --dockerfile option to modal_sandbox.py create commands","description":"Update modal_sandbox.py to support building images from Dockerfiles.\n\nAdd a --dockerfile option to the create commands (create default, create rust) that:\n1. Takes a relative path to a Dockerfile  \n2. Uses modal.Image.from_dockerfile() to build the image instead of the hardcoded image definition\n3. Falls back to existing behavior when --dockerfile is not provided\n\nThe Dockerfile path should be resolved relative to the current working directory.\n\nFiles to modify:\n- scripts/modal_sandbox.py (add --dockerfile option to create subcommands)","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-29T19:54:23.477729968Z","created_by":"Danver Braganza","updated_at":"2026-01-29T20:39:29.92591743Z"}
{"id":"code-18","title":"Update offload-modal.toml and offload-cargo-modal.toml to use Dockerfile","description":"Update the local example config files to use the new dockerfile_path feature.\n\nChanges needed:\n1. Add dockerfile_path = '.devcontainer/Dockerfile' to the [provider] section\n2. Update create_command to pass the --dockerfile flag with the path\n\nThese are the 'local examples' - configs designed to work with the offload repo itself.\n\nFiles to modify:\n- offload-modal.toml  \n- offload-cargo-modal.toml","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-29T19:54:30.062342929Z","created_by":"Danver Braganza","updated_at":"2026-01-29T20:43:18.762483175Z"}
{"id":"code-19","title":"Expand dockerfile_path placeholder in create_command","description":"The create_command is run without expanding the {dockerfile_path} placeholder, causing a FileNotFoundError when trying to use the dockerfile_path feature.\n\nIn src/provider/default.rs, the create_sandbox method runs self.config.create_command directly without substituting {dockerfile_path}.\n\nFix: Before running the create_command, replace {dockerfile_path} with the actual value from self.config.dockerfile_path (or empty string if None).\n\nLocation: src/provider/default.rs, create_sandbox method around line 147","status":"done","priority":0,"issue_type":"bug","created_at":"2026-01-29T23:07:39.196891168Z","created_by":"Danver Braganza","updated_at":"2026-01-29T23:10:46.755272839Z"}
{"id":"code-2","title":"Rename config/mod.rs to config.rs (2018+ module style)","description":"Rename src/config/mod.rs to src/config.rs following STYLE_GUIDE.md. The config directory contains schema.rs which should remain in src/config/. Update lib.rs module declaration accordingly.","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-27T00:03:33.391277628Z","created_by":"Danver Braganza","updated_at":"2026-01-27T00:10:46.641763218Z"}
{"id":"code-20","title":"Restructure modal_sandbox.py: separate dockerfile command from existing commands","description":"Currently --dockerfile is a flag on 'create default' and 'create rust'. This makes the build slow when dockerfile is used.\n\nRestructure so that:\n1. 'create dockerfile \u003cpath\u003e' - new command that builds from a Dockerfile. Must validate the file exists and print sensible error if not.\n2. 'create default', 'create rust', etc. - keep using their hardcoded modal.Image definitions (fast path)\n\nThis allows users to choose:\n- Fast: use the built-in image definitions (coupled but fast)\n- Flexible: use a Dockerfile (slow but decoupled)\n\nChanges needed:\n1. Remove --dockerfile option from create_default and create_rust\n2. Add new 'create dockerfile' subcommand that takes a path argument\n3. Update the TOML configs to use 'create dockerfile .devcontainer/Dockerfile' instead of 'create default --dockerfile {dockerfile_path}'","status":"done","priority":0,"issue_type":"task","created_at":"2026-01-29T23:35:56.740078843Z","created_by":"Danver Braganza","updated_at":"2026-01-29T23:42:19.484075673Z"}
{"id":"code-21","title":"Bump ratchet no-bare-print budget for scripts","description":"The new create dockerfile command in modal_sandbox.py adds 2 print statements:\n1. Error message to stderr when dockerfile not found\n2. sandbox.object_id output (standard pattern for create commands)\n\nThese are legitimate uses in a CLI script. Bump the ratchet budget from 25 to 27.\n\nFile to modify: ratchet-counts.toml","status":"done","priority":0,"issue_type":"task","created_at":"2026-01-29T23:40:04.172825263Z","created_by":"Danver Braganza","updated_at":"2026-01-29T23:42:19.493969048Z"}
{"id":"code-22","title":"Add image cache infrastructure to modal_sandbox.py","description":"Add infrastructure for caching Modal image IDs:\n\n1. Add CACHE_DIR constant (~/.cache/offload/)\n2. Add ImageCacheEntry dataclass with fields: image_id, dockerfile_hash, mtime, created_at\n3. Add functions: get_cache_path(), load_cache(), save_cache(), compute_dockerfile_hash()\n4. Cache is stored as JSON in ~/.cache/offload/modal-images.json\n\nFiles to modify: scripts/modal_sandbox.py only","status":"in_progress","priority":1,"issue_type":"task","created_at":"2026-01-30T17:03:41.744724138Z","created_by":"Danver Braganza","updated_at":"2026-01-30T17:04:50.692039045Z","dependencies":[{"issue_id":"code-22","depends_on_id":"code-26","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"code-23","title":"Add build-image subcommand to modal_sandbox.py","description":"Add a new 'build-image' subcommand group that eagerly builds Modal images and caches their IDs:\n\n1. Add @cli.group() for 'build-image' subcommand\n2. Add build-image subcommands for each sandbox type (default, rust, dockerfile, computronium, sculptor, mngr)\n3. Each subcommand:\n   - Builds the image using image.build(app)\n   - Extracts image.object_id\n   - Computes dockerfile hash (if applicable)\n   - Saves to cache via save_cache()\n   - Prints the image_id to stdout\n\nFiles to modify: scripts/modal_sandbox.py only\n\nDepends on: code-22","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T17:03:51.313432628Z","created_by":"Danver Braganza","updated_at":"2026-01-30T17:03:51.313432628Z","dependencies":[{"issue_id":"code-23","depends_on_id":"code-22","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"code-24","title":"Modify create subcommands to use cached images","description":"Update each create subcommand to check for and use cached image IDs:\n\n1. At the start of each create subcommand (default, rust, dockerfile, computronium, sculptor, mngr):\n   - Load cache and check for valid cached image for this sandbox type\n   - If cached and valid (hash matches, not expired), use modal.Image.from_id(cached_image_id)\n   - If not cached or invalid, fall back to current behavior (build image inline)\n   - Optionally update cache after successful sandbox creation\n\n2. Add --force-rebuild flag to skip cache lookup\n\n3. Print cache status to stderr (e.g., 'Using cached image im-xxx' or 'Building fresh image...')\n\nFiles to modify: scripts/modal_sandbox.py only\n\nDepends on: code-22, code-23","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T17:03:59.448569882Z","created_by":"Danver Braganza","updated_at":"2026-01-30T17:03:59.448569882Z","dependencies":[{"issue_id":"code-24","depends_on_id":"code-22","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"code-24","depends_on_id":"code-23","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"code-25","title":"Add cache-status and cache-clear subcommands","description":"Add utility subcommands for cache management:\n\n1. Add 'cache-status' subcommand:\n   - Shows all cached images with their IDs, sandbox types, creation dates\n   - Shows cache file location\n   - Indicates if images are valid/stale\n\n2. Add 'cache-clear' subcommand:\n   - Clears all cached image entries\n   - Add optional --type flag to clear only specific sandbox type\n\nFiles to modify: scripts/modal_sandbox.py only\n\nDepends on: code-22","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-30T17:04:06.06834801Z","created_by":"Danver Braganza","updated_at":"2026-01-30T17:04:06.06834801Z","dependencies":[{"issue_id":"code-25","depends_on_id":"code-22","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"code-26","title":"Bump ratchet budget for no-dataclasses-import in scripts","description":"Bump the ratchet budget for no-dataclasses-import rule to allow dataclasses usage in scripts/modal_sandbox.py.\n\nAdd the following to ratchet-counts.toml:\n[no-dataclasses-import]\n\"scripts\" = 1\n\nThis is required for the image cache infrastructure (code-22) which uses @dataclass for ImageCacheEntry.\n\nFiles to modify: ratchet-counts.toml only","status":"done","priority":0,"issue_type":"task","created_at":"2026-01-30T17:11:22.842352712Z","created_by":"Danver Braganza","updated_at":"2026-01-30T17:14:06.181033635Z"}
{"id":"code-3","title":"Rename discovery/mod.rs to discovery.rs (2018+ module style)","description":"Rename src/discovery/mod.rs to src/discovery.rs following STYLE_GUIDE.md. The discovery directory contains cargo.rs, generic.rs, pytest.rs which should remain in src/discovery/. Update lib.rs module declaration accordingly.","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-27T00:03:34.165780754Z","created_by":"Danver Braganza","updated_at":"2026-01-27T00:13:00.993596085Z"}
{"id":"code-4","title":"Rename executor/mod.rs to executor.rs (2018+ module style)","description":"Rename src/executor/mod.rs to src/executor.rs following STYLE_GUIDE.md. The executor directory contains retry.rs, runner.rs, scheduler.rs which should remain in src/executor/. Update lib.rs module declaration accordingly.","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-27T00:03:35.156671629Z","created_by":"Danver Braganza","updated_at":"2026-01-27T00:15:04.701572295Z"}
{"id":"code-5","title":"Rename provider/mod.rs to provider.rs (2018+ module style)","description":"Rename src/provider/mod.rs to src/provider.rs following STYLE_GUIDE.md. The provider directory contains docker.rs, process.rs, remote.rs, ssh.rs which should remain in src/provider/. Update lib.rs module declaration accordingly.","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-27T00:03:35.716959671Z","created_by":"Danver Braganza","updated_at":"2026-01-27T00:17:13.043386841Z"}
{"id":"code-6","title":"Rename report/mod.rs to report.rs (2018+ module style)","description":"Rename src/report/mod.rs to src/report.rs following STYLE_GUIDE.md. The report directory contains junit.rs which should remain in src/report/. Update lib.rs module declaration accordingly.","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-27T00:03:36.326795046Z","created_by":"Danver Braganza","updated_at":"2026-01-27T00:19:18.464449969Z"}
{"id":"code-7","title":"Resolve duplicate thiserror dependency versions","description":"The codebase has duplicate versions of thiserror (v1.0.69 and v2.0.18).\n\nDetails:\n- offload directly depends on thiserror v1.0.69\n- bollard (docker client) transitively pulls in thiserror v2.0.18\n- This creates unnecessary binary bloat\n\nResolution options:\n1. Update bollard dependency to a version that uses thiserror v1.x (if available)\n2. Update offload to use thiserror v2.x to match bollard\n3. Document as acceptable if no easy resolution exists\n\nImpact: Low priority - builds work fine, but increases binary size slightly.","status":"done","priority":2,"issue_type":"task","created_at":"2026-01-27T00:20:50.872026178Z","created_by":"Danver Braganza","updated_at":"2026-01-27T00:26:51.431231803Z"}
{"id":"code-8","title":"Rename executor module to orchestrator","description":"Comprehensively rename the 'executor' module to 'orchestrator' since Orchestrator is its key component.\n\nFiles to rename:\n- src/executor.rs → src/orchestrator.rs\n- src/executor/ directory → src/orchestrator/ directory\n- src/executor/runner.rs → src/orchestrator/runner.rs\n- src/executor/retry.rs → src/orchestrator/retry.rs\n- src/executor/scheduler.rs → src/orchestrator/scheduler.rs\n\nReferences to update:\n- lib.rs: pub mod executor → pub mod orchestrator, re-exports\n- main.rs: use offload::executor::Orchestrator\n- report.rs: use crate::executor::RunResult\n- report/junit.rs: use crate::executor::RunResult\n- Documentation strings in executor.rs, lib.rs, runner.rs, retry.rs, scheduler.rs\n\nDoc comments referencing offload::executor::* must be updated to offload::orchestrator::*","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-28T18:57:46.210148216Z","created_by":"Danver Braganza","updated_at":"2026-01-28T19:05:06.97055317Z"}
{"id":"code-9","title":"Rename project: Update Cargo.toml from offload to offload","description":"Update Cargo.toml to rename the package, binary, and library from 'offload' to 'offload'. This is part of the project rename from offload/trawl to offload.","status":"done","priority":1,"issue_type":"task","created_at":"2026-01-29T18:24:47.950373384Z","created_by":"Danver Braganza","updated_at":"2026-01-29T18:28:38.897329Z"}
